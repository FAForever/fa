- (#6495, #6562) Refactor the map utilities module

Chunks up some larger functions into smaller functions to allow them to be re-used in other modules.
